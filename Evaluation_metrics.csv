Question,Expected SQL,Predicted SQL,Exec Match,Latency (s)
List all tasks along with the names of the users assigned to them in order.,"SELECT t.task_name, u.name FROM tasks t JOIN users u ON t.assigned_to = u.user_id ORDER BY u.name;","SELECT tasks.task_name, users.name AS assigned_to
FROM tasks
JOIN users ON tasks.assigned_to = users.user_id
ORDER BY tasks.task_id;",True,10.073
Show all projects and the total number of tasks assigned to each project.,"SELECT p.project_name, COUNT(t.task_id) AS total_tasks FROM projects p LEFT JOIN tasks t ON p.project_id = t.project_id GROUP BY p.project_name;","WITH project_task_counts AS (
    SELECT p.project_id, p.project_name, COUNT(t.task_id) AS total_tasks
    FROM projects p
    LEFT JOIN tasks t ON p.project_id = t.project_id
    GROUP BY p.project_id, p.project_name
)
SELECT project_name, total_tasks
FROM project_task_counts;",True,5.726
What are the names of all the departments?,SELECT dept_name FROM departments;,SELECT dept_name FROM departments;,True,3.292
Find users assigned to the project with the most tasks.,SELECT DISTINCT u.name FROM users u JOIN tasks t ON u.user_id = t.assigned_to WHERE t.project_id = (SELECT project_id FROM tasks GROUP BY project_id ORDER BY COUNT(*) DESC LIMIT 1);,"WITH project_task_counts AS (
    SELECT project_id, COUNT(task_id) AS task_count
    FROM tasks
    GROUP BY project_id
),
max_task_project AS (
    SELECT project_id
    FROM project_task_counts
    ORDER BY task_count DESC
    LIMIT 1
)
SELECT u.name
FROM users u
JOIN tasks t ON u.user_id = t.assigned_to
JOIN max_task_project mtp ON t.project_id = mtp.project_id;",True,4.484
What is the total budget allocated for each project?,"SELECT p.project_name, SUM(pb.allocated_budget) as total_budget FROM projects p LEFT JOIN project_budgets pb ON p.project_id = pb.project_id GROUP BY p.project_id, p.project_name ORDER BY total_budget DESC;","WITH project_budget_totals AS (
    SELECT project_id, SUM(allocated_budget) AS total_allocated_budget
    FROM project_budgets
    GROUP BY project_id
)
SELECT projects.project_name, project_budget_totals.total_allocated_budget
FROM projects
LEFT JOIN project_budget_totals ON projects.project_id = project_budget_totals.project_id;",True,5.937
How many hours has each user logged in total?,"SELECT u.name, SUM(tl.hours_worked) as total_hours FROM users u JOIN time_logs tl ON u.user_id = tl.user_id GROUP BY u.user_id, u.name ORDER BY total_hours DESC;","SELECT u.name, u.user_id, SUM(tl.hours_worked) AS total_hours_logged
FROM users u
LEFT JOIN time_logs tl ON u.user_id = tl.user_id
GROUP BY u.user_id, u.name
ORDER BY total_hours_logged DESC;",False,6.753
List users who have no tasks assigned.,SELECT name FROM users WHERE user_id NOT IN (SELECT DISTINCT assigned_to FROM tasks);,"SELECT u.name
FROM users u
LEFT JOIN tasks t ON u.user_id = t.assigned_to
WHERE t.task_id IS NULL;",True,4.104
Find users who havent logged any time this month.,"SELECT users.name, users.email, users.role FROM users LEFT JOIN time_logs ON users.user_id = time_logs.user_id AND time_logs.log_date >= DATE_FORMAT(CURDATE(), '%Y-%m-01') WHERE time_logs.user_id is NULL;","WITH users_this_month AS (
    SELECT DISTINCT user_id
    FROM time_logs
    WHERE MONTH(log_date) = MONTH(CURDATE()) AND YEAR(log_date) = YEAR(CURDATE())
)
SELECT u.name
FROM users u
LEFT JOIN users_this_month um ON u.user_id = um.user_id
WHERE um.user_id IS NULL;",False,5.211
Show projects and the percentage of completed tasks using a CTE.,"WITH task_summary AS (SELECT project_id, COUNT(*) AS total_tasks, SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) AS completed_tasks FROM tasks GROUP BY project_id) SELECT p.project_name, ts.total_tasks, ts.completed_tasks, ROUND((ts.completed_tasks / ts.total_tasks) * 100, 2) AS completion_percentage FROM projects p JOIN task_summary ts ON p.project_id = ts.project_id;","WITH task_counts AS (
    SELECT p.project_id, p.project_name, COUNT(t.task_id) AS total_tasks, SUM(t.status = 'completed') AS completed_tasks
    FROM projects p
    LEFT JOIN tasks t ON p.project_id = t.project_id
    GROUP BY p.project_id, p.project_name
)
SELECT project_name, total_tasks, completed_tasks, 
    CASE 
        WHEN total_tasks = 0 THEN 0 
        ELSE ROUND(completed_tasks / total_tasks * 100, 2) 
    END AS completion_rate_pct
FROM task_counts
ORDER BY completion_rate_pct DESC;",True,12.151
List users who have overdue tasks and the count of those tasks.,"WITH overdue_tasks AS (SELECT assigned_to, COUNT(*) AS overdue_count FROM tasks WHERE due_date < CURDATE() AND status != 'completed' GROUP BY assigned_to) SELECT u.name, ot.overdue_count FROM users u JOIN overdue_tasks ot ON u.user_id = ot.assigned_to;","WITH overdue_tasks AS (
    SELECT u.user_id, u.name, COUNT(t.task_id) AS overdue_task_count
    FROM users u
    JOIN tasks t ON u.user_id = t.assigned_to
    WHERE t.due_date < CURDATE() AND t.status != 'completed'
    GROUP BY u.user_id, u.name
)
SELECT name, overdue_task_count
FROM overdue_tasks;",True,6.042
